---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
library(Seurat)
library(tidyverse)
library(here)
library(DoMultiBarHeatmap)
```

```{r}
macrophage <- readRDS(here('explore/RDS/macrophage_new_submain.RDS'))
```

```{r}
unique(macrophage$new_submain3)
```

```{r}
Idents(macrophage) <- "new_submain3"
DefaultAssay(macrophage) <- "integrated"

macrophage_markers <- FindAllMarkers(macrophage, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

top10 <- macrophage_markers %>% 
  group_by(cluster) %>% 
  top_n(n = 10, wt = avg_log2FC)

```

```{r}
#DoHeatmap(macrophage, features = top10$gene) + NoLegend() 

```


